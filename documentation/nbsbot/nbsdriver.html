<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 9.0.1" />
    <title>nbsbot.nbsdriver API documentation</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2264%22%20height%3D%2264%22%20viewBox%3D%2244.5%202.5%2015%2015%22%3E%3Cpath%20d%3D%22M49.351%2021.041c-.233-.721-.546-2.408-.772-4.076-.042-.09-.067-.187-.046-.288-.166-1.347-.277-2.625-.241-3.351-1.378-1.008-2.271-2.586-2.271-4.362%200-.976.272-1.935.788-2.774.057-.094.122-.18.184-.268-.033-.167-.052-.339-.052-.516%200-1.477%201.202-2.679%202.679-2.679.791%200%201.496.352%201.987.9a6.3%206.3%200%200%201%201.001.029c.492-.564%201.207-.929%202.012-.929%201.477%200%202.679%201.202%202.679%202.679a2.65%202.65%200%200%201-.269%201.148c.383.747.595%201.572.595%202.41%200%202.311-1.507%204.29-3.635%205.107.037.699.147%202.27.423%203.294l.137.461c.156%202.136-4.612%205.166-5.199%203.215zm.127-4.919a4.78%204.78%200%200%200%20.775-.584c-.172-.115-.505-.254-.88-.378zm.331%202.302l.828-.502c-.202-.143-.576-.328-.984-.49zm.45%202.157l.701-.403c-.214-.115-.536-.249-.891-.376l.19.779zM49.13%204.141c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm.735-.389a1.15%201.15%200%200%201%20.314.783%201.16%201.16%200%200%201-1.162%201.162c-.457%200-.842-.27-1.032-.653-.026.117-.042.238-.042.362a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.843-.626-1.535-1.436-1.654zm3.076%201.654a1.68%201.68%200%200%200%201.679%201.679%201.68%201.68%200%200%200%201.679-1.679c0-.037-.009-.072-.011-.109-.21.3-.541.508-.935.508a1.16%201.16%200%200%201-1.162-1.162%201.14%201.14%200%200%201%20.474-.912c-.015%200-.03-.005-.045-.005-.926.001-1.679.754-1.679%201.68zm1.861-1.265c0%20.152.123.276.276.276s.275-.124.275-.276-.123-.276-.276-.276-.275.124-.275.276zm1.823%204.823c0-.52-.103-1.035-.288-1.52-.466.394-1.06.64-1.717.64-1.144%200-2.116-.725-2.499-1.738-.383%201.012-1.355%201.738-2.499%201.738-.867%200-1.631-.421-2.121-1.062-.307.605-.478%201.267-.478%201.942%200%202.486%202.153%204.51%204.801%204.51s4.801-2.023%204.801-4.51zm-3.032%209.156l-.146-.492c-.276-1.02-.395-2.457-.444-3.268a6.11%206.11%200%200%201-1.18.115%206.01%206.01%200%200%201-2.536-.562l.006.175c.802.215%201.848.612%202.021%201.25.079.295-.021.601-.274.837l-.598.501c.667.304%201.243.698%201.311%201.179.02.144.022.507-.393.787l-.564.365c1.285.521%201.361.96%201.381%201.126.018.142.011.496-.427.746l-.854.489c.064-1.19%201.985-2.585%202.697-3.248zM49.34%209.925c0-.667%201-.667%201%200%200%20.653.818%201.205%201.787%201.205s1.787-.552%201.787-1.205c0-.667%201-.667%201%200%200%201.216-1.25%202.205-2.787%202.205s-2.787-.989-2.787-2.205zm-.887-7.633c-.093.077-.205.114-.317.114a.5.5%200%200%201-.318-.886L49.183.397a.5.5%200%200%201%20.703.068.5.5%200%200%201-.069.703zm7.661-.065c-.086%200-.173-.022-.253-.068l-1.523-.893c-.575-.337-.069-1.2.506-.863l1.523.892a.5.5%200%200%201%20.179.685c-.094.158-.261.247-.432.247z%22%20fill%3D%22%233bb300%22/%3E%3C/svg%3E"/>


<style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
<style>/*! pygments syntax highlighting */pre{line-height:125%;}td.linenos pre{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}span.linenos{color:#000000; background-color:#f0f0f0; padding-left:5px; padding-right:5px;}td.linenos pre.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}span.linenos.special{color:#000000; background-color:#ffffc0; padding-left:5px; padding-right:5px;}.pdoc .hll{background-color:#ffffcc}.pdoc{background:#f8f8f8;}.pdoc .c{color:#408080; font-style:italic}.pdoc .err{border:1px solid #FF0000}.pdoc .k{color:#008000; font-weight:bold}.pdoc .o{color:#666666}.pdoc .ch{color:#408080; font-style:italic}.pdoc .cm{color:#408080; font-style:italic}.pdoc .cp{color:#BC7A00}.pdoc .cpf{color:#408080; font-style:italic}.pdoc .c1{color:#408080; font-style:italic}.pdoc .cs{color:#408080; font-style:italic}.pdoc .gd{color:#A00000}.pdoc .ge{font-style:italic}.pdoc .gr{color:#FF0000}.pdoc .gh{color:#000080; font-weight:bold}.pdoc .gi{color:#00A000}.pdoc .go{color:#888888}.pdoc .gp{color:#000080; font-weight:bold}.pdoc .gs{font-weight:bold}.pdoc .gu{color:#800080; font-weight:bold}.pdoc .gt{color:#0044DD}.pdoc .kc{color:#008000; font-weight:bold}.pdoc .kd{color:#008000; font-weight:bold}.pdoc .kn{color:#008000; font-weight:bold}.pdoc .kp{color:#008000}.pdoc .kr{color:#008000; font-weight:bold}.pdoc .kt{color:#B00040}.pdoc .m{color:#666666}.pdoc .s{color:#BA2121}.pdoc .na{color:#7D9029}.pdoc .nb{color:#008000}.pdoc .nc{color:#0000FF; font-weight:bold}.pdoc .no{color:#880000}.pdoc .nd{color:#AA22FF}.pdoc .ni{color:#999999; font-weight:bold}.pdoc .ne{color:#D2413A; font-weight:bold}.pdoc .nf{color:#0000FF}.pdoc .nl{color:#A0A000}.pdoc .nn{color:#0000FF; font-weight:bold}.pdoc .nt{color:#008000; font-weight:bold}.pdoc .nv{color:#19177C}.pdoc .ow{color:#AA22FF; font-weight:bold}.pdoc .w{color:#bbbbbb}.pdoc .mb{color:#666666}.pdoc .mf{color:#666666}.pdoc .mh{color:#666666}.pdoc .mi{color:#666666}.pdoc .mo{color:#666666}.pdoc .sa{color:#BA2121}.pdoc .sb{color:#BA2121}.pdoc .sc{color:#BA2121}.pdoc .dl{color:#BA2121}.pdoc .sd{color:#BA2121; font-style:italic}.pdoc .s2{color:#BA2121}.pdoc .se{color:#BB6622; font-weight:bold}.pdoc .sh{color:#BA2121}.pdoc .si{color:#BB6688; font-weight:bold}.pdoc .sx{color:#008000}.pdoc .sr{color:#BB6688}.pdoc .s1{color:#BA2121}.pdoc .ss{color:#19177C}.pdoc .bp{color:#008000}.pdoc .fm{color:#0000FF}.pdoc .vc{color:#19177C}.pdoc .vg{color:#19177C}.pdoc .vi{color:#19177C}.pdoc .vm{color:#19177C}.pdoc .il{color:#666666}</style>
<style>/*! pdoc */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f7f7f7;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}body{background-color:var(--pdoc-background);}html, body{width:100%;height:100%;}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;}nav.pdoc{--pad:1.75rem;--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc li{display:block;margin:0;padding:.2rem 0 .2rem var(--indent);transition:all 100ms;}nav.pdoc > div > ul > li{padding-left:0;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}html, main{scroll-behavior:smooth;}.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{background-color:var(--code);border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{filter:opacity(1);}.pdoc details:not([open]){height:0;}.pdoc details > summary{position:absolute;top:-35px;right:0;font-size:.75rem;color:var(--muted);padding:0 .7em;user-select:none;}.pdoc details > summary:focus{outline:0;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc > section:first-of-type > .docstring{margin-bottom:2.5rem;}.pdoc .docstring pre{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;user-select:none;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:.5rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
</head>
<body>        <nav class="pdoc">
            <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
            <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
            <div>
                        <a class="pdoc-button module-list-button" href="../nbsbot.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                            &nbsp;nbsbot</a>


                        <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                               pattern=".+" required>



                    <h2>API Documentation</h2>
                        <ul class="memberlist">
            <li>
                    <a class="class" href="#NBSdriver">NBSdriver</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#NBSdriver.__init__">NBSdriver</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.get_credentials">get_credentials</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.log_in">log_in</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_id">go_to_id</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.clean_patient_id">clean_patient_id</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_summary">go_to_summary</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_events">go_to_events</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_demographics">go_to_demographics</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_home">go_to_home</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.GoToApprovalQueue">GoToApprovalQueue</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.ReturnApprovalQueue">ReturnApprovalQueue</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.SortApprovalQueue">SortApprovalQueue</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.HandleBadQueueReturn">HandleBadQueueReturn</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.CheckFirstCase">CheckFirstCase</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.GoToFirstCaseInApprovalQueue">GoToFirstCaseInApprovalQueue</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.GoToCaseInfo">GoToCaseInfo</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.GoToCOVID">GoToCOVID</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_lab">go_to_lab</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.read_investigation_table">read_investigation_table</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_investigation_by_index">go_to_investigation_by_index</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_investigation_by_id">go_to_investigation_by_id</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.return_to_patient_profile_from_inv">return_to_patient_profile_from_inv</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.return_to_patient_profile_from_lab">return_to_patient_profile_from_lab</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.click_submit">click_submit</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.click_manage_associations_submit">click_manage_associations_submit</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.enter_edit_mode">enter_edit_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.click_cancel">click_cancel</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_manage_associations">go_to_manage_associations</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.CheckForValue">CheckForValue</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.check_for_value_bool">check_for_value_bool</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.ReadDate">ReadDate</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.CheckIfField">CheckIfField</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.ReadText">ReadText</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.ReadTableToDF">ReadTableToDF</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.ReadPatientID">ReadPatientID</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.Sleep">Sleep</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.send_email_local_outlook_client">send_email_local_outlook_client</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.clear_gen_py">clear_gen_py</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.read_config">read_config</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.get_email_info">get_email_info</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.get_usps_user_id">get_usps_user_id</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.send_smtp_email">send_smtp_email</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.get_main_window_handle">get_main_window_handle</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.switch_to_secondary_window">switch_to_secondary_window</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.select_checkbox">select_checkbox</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.unselect_checkbox">unselect_checkbox</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.county_lookup">county_lookup</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.zip_code_lookup">zip_code_lookup</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.check_for_error_page">check_for_error_page</a>
                        </li>
                        <li>
                                <a class="function" href="#NBSdriver.go_to_home_from_error_page">go_to_home_from_error_page</a>
                        </li>
                </ul>

            </li>
    </ul>



                    <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
                        built with <span class="visually-hidden">pdoc</span><img
                            alt="pdoc logo"
                            src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
                    </a>
            </div>
        </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
<a href="./../nbsbot.html">nbsbot</a><wbr>.nbsdriver    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">win32com.client</span> <span class="k">as</span> <span class="nn">win32</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">rmtree</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">TimeoutException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">ElementClickInterceptedException</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoAlertPresentException</span>
<span class="kn">import</span> <span class="nn">configparser</span>
<span class="kn">import</span> <span class="nn">smtplib</span>
<span class="kn">from</span> <span class="nn">email.message</span> <span class="kn">import</span> <span class="n">EmailMessage</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">geopy.geocoders</span> <span class="kn">import</span> <span class="n">Nominatim</span>
<span class="kn">from</span> <span class="nn">usps</span> <span class="kn">import</span> <span class="n">USPSApi</span><span class="p">,</span> <span class="n">Address</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">class</span> <span class="nc">NBSdriver</span><span class="p">(</span><span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A class to provide basic functionality in NBS via Selenium. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">production</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">production</span> <span class="o">=</span> <span class="n">production</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_email_info</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_usps_user_id</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">production</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbs.iphis.maine.gov/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbstest.state.me.us/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;chromedriver.exe&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;log-level=3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-ssl-errors=yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NBSdriver</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">=</span> <span class="mi">3300</span> <span class="c1">#Value in seconds</span>


<span class="c1">########################### NBS Navigation Methods ############################</span>
    <span class="k">def</span> <span class="nf">get_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to prompt user to provide a valid username and RSA token</span>
<span class="sd">        to log in to NBS. Must &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your SOM username (&quot;first_name.last_name&quot;):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passcode</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your RSA passcode:&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Log in to NBS. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s2">&quot;contentFrame&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;passcode&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passcode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;/html/body/div[2]/p[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to specifc patient by NBS ID from Home. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;DEM229&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;patientSearchByDetails&quot;]/table[2]/tbody/tr[8]/td[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">search_result_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;searchResultsTable&quot;]/tbody/tr/td[1]/a&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clean_patient_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the leading and trailing characters from local patient</span>
<span class="sd">        ids to leave an id that is searchable in through the front end of NBS.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN1&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN2&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">patient_id</span>

    <span class="k">def</span> <span class="nf">go_to_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Summary tab.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head0&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within patient profile navigate to the Events tab. &quot;&quot;&quot;</span>
        <span class="n">events_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">error_encountered</span>

    <span class="k">def</span> <span class="nf">go_to_demographics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Demographics tab.&quot;&quot;&quot;</span>
        <span class="n">demographics_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">demographics_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page. &quot;&quot;&quot;</span>
        <span class="c1">#xpath = &#39;//*[@id=&quot;bd&quot;]/table[1]/tbody/tr/td[1]/table/tbody/tr/td[1]/a&#39;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Home&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1">#WebDriverWait(self,self.wait_before_timeout).until(EC.presence_of_element_located((By.XPATH, xpath)))</span>
                <span class="c1">#self.find_element(By.XPATH, xpath).click()</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">GoToApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to approval queue from Home page. &quot;&quot;&quot;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Approval Queue for Initial Notifications&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ReturnApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return to Approval Queue from an investigation initally accessed from the queue. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">SortApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sort approval queue so that case are listed chronologically by</span>
<span class="sd">        notification creation date and in reverse alpha order so that</span>
<span class="sd">        &quot;2019 Novel...&quot; is at the top. &quot;&quot;&quot;</span>
        <span class="n">clear_filter_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;removeFilters&quot;]/a/font&#39;</span>
        <span class="n">submit_date_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[3]/a&#39;</span>
        <span class="n">condition_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[8]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Clear all filters</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click submit date for chronological order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click condition for reverse alpha order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">TimeoutException</span><span class="p">,</span> <span class="n">ElementClickInterceptedException</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">HandleBadQueueReturn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; When a request is sent to NBS to load or filter the approval queue</span>
<span class="sd">        and &quot;Nothing found to display&quot;, or anything other than the populated</span>
<span class="sd">        queue is returned, navigate back to the home page and request the queue</span>
<span class="sd">        again.&quot;&quot;&quot;</span>
        <span class="c1"># Recursion seems like a good idea here, but if the queue is truly empty there will be nothing to display and recursion will result in a stack overflow.</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">go_to_home</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GoToApprovalQueue</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load approval queue. Either to queue is truly empty, or a persistent issue with NBS was encountered.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">CheckFirstCase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure that first case is COVID and save case&#39;s name for later use.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[7]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">GoToFirstCaseInApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to first case in the approval queue. &quot;&quot;&quot;</span>
        <span class="n">xpath_to_case</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span>
        <span class="n">xpath_to_first_name</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;DEM104&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Make sure queue loads properly before navigating to first case.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Make sure first case loads properly before moving on.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_first_name</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GoToCaseInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the Case Info tab. &quot;&quot;&quot;</span>
        <span class="n">case_info_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span> <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GoToCOVID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the COVID tab. &quot;&quot;&quot;</span>
        <span class="n">covid_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to a lab from a patient profile navigate to a lab. &quot;&quot;&quot;</span>
        <span class="n">lab_report_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;lab1&quot;]&#39;</span>
        <span class="n">lab_report_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">lab_report_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab_report_table</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="n">lab_report_table</span><span class="p">[</span><span class="n">lab_report_table</span><span class="p">[</span><span class="s1">&#39;Event ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab_id</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lab_row_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr[</span><span class="si">{</span><span class="n">lab_row_index</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">lab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_investigation_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read the investigations table in the Events tab of a patient profile</span>
<span class="sd">        of all investigations on record, both open and closed.&quot;&quot;&quot;</span>
        <span class="n">investigation_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;inv1&quot;]&#39;</span>
        <span class="n">investigation_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">investigation_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
            <span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">investigation_table</span>

    <span class="k">def</span> <span class="nf">go_to_investigation_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an existing investigation based on its position in the</span>
<span class="sd">        Investigations table in the Events tab of a patient profile.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr[</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">existing_investigation_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_investigation_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an investigation with a given id from a patient profile.&quot;&quot;&quot;</span>
        <span class="n">inv_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_investigation_table</span><span class="p">()</span>
        <span class="n">inv_row</span> <span class="o">=</span> <span class="n">inv_table</span><span class="p">[</span><span class="n">inv_table</span><span class="p">[</span><span class="s1">&#39;Investigation ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">inv_id</span><span class="p">]</span>
        <span class="n">inv_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inv_row</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">go_to_investigation_by_index</span><span class="p">(</span><span class="n">inv_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within an investigation.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within a lab report.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;doc3&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">click_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button to save changes.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">click_manage_associations_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button in the Manage Associations window.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/div/table[2]/tbody/tr/td/table/tbody/tr/td[2]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">enter_edit_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From within an investigation click the edit button to enter edit mode.&quot;&quot;&quot;</span>
        <span class="n">edit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">edit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">click_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click cancel.&quot;&quot;&quot;</span>
        <span class="n">cancel_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;Cancel&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">cancel_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_manage_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click button to navigate to the Manage Associations page from an investigation.&quot;&quot;&quot;</span>
        <span class="n">manage_associations_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;manageAssociations&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">manage_associations_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>
<span class="c1">############################# Data Reading/Validation Methods ##################################</span>

    <span class="k">def</span> <span class="nf">CheckForValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">blank_message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If value is blank add appropriate message to list of issues. &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blank_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">check_for_value_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return boolean value based on whether a value is present.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">def</span> <span class="nf">ReadDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;innerText&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read date from NBS and return a datetime.date object. &quot;&quot;&quot;</span>
        <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">date</span>

    <span class="k">def</span> <span class="nf">CheckIfField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If parent field is value ensure that child field is not blank. &quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ReadText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read the text of any web element identified by an Xpath</span>
<span class="sd">        and remove leading an trailing carriage returns sometimes included by</span>
<span class="sd">        Selenium&#39;s get_attribute(&#39;innerText&#39;).&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">ReadTableToDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read tables into pandas Data Frames for easy manipulation. &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">table</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">table</span>

    <span class="k">def</span> <span class="nf">ReadPatientID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read patient ID from within patient profile. &quot;&quot;&quot;</span>
        <span class="n">patient_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="s1">&#39;//*[@id=&quot;bd&quot;]/table[3]/tbody/tr[1]/td[2]/span[2]&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">patient_id</span>

    <span class="k">def</span> <span class="nf">Sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pause all action for the specified number of seconds. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span><span class="p">):</span>
            <span class="n">time_remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">-</span> <span class="n">i</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sleeping for: </span><span class="si">{</span><span class="n">time_remaining</span><span class="o">//</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">time_remaining</span><span class="o">%</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sleeping for: 00:00&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_email_local_outlook_client</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">attachment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send an email using local Outlook client.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_gen_py</span><span class="p">()</span>
        <span class="n">outlook</span> <span class="o">=</span> <span class="n">win32</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;outlook.application&#39;</span><span class="p">)</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">outlook</span><span class="o">.</span><span class="n">CreateItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">GetInspector</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">To</span> <span class="o">=</span> <span class="n">recipient</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">CC</span> <span class="o">=</span> <span class="n">cc</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Subject</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Body</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">if</span> <span class="n">attachment</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mail</span><span class="o">.</span><span class="n">Attachments</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Send</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear_gen_py</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear the contents of the the gen_py directory to ensure emails can</span>
<span class="sd">        always be sent.&quot;&quot;&quot;</span>
        <span class="c1"># Construct to path gen_py directory if it exists.</span>
        <span class="n">current_user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">current_user</span> <span class="o">+</span> <span class="s1">&#39;\AppData\Local\Temp\gen_py&#39;</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>

        <span class="c1"># If gen_py exists delete it and all contents.</span>
        <span class="k">if</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read in data from config.cfg&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;config.cfg&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_email_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read information required for NBSbot to send emails via an smtp</span>
<span class="sd">        server to various email lists.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;smtp_server&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;nbsbot_email&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_informatics_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_informatics_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_admin_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_admin_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_commander</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_commander&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_usps_user_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Extract the USPS User ID from the config file for later use in the</span>
<span class="sd">        zip_code_lookup() method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;usps&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_smtp_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">email_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send emails using an SMTP server &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">EmailMessage</span><span class="p">()</span>
        <span class="n">message</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">receiver</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
           <span class="n">smtpObj</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span><span class="p">)</span>
           <span class="n">smtpObj</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully sent </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SMTPException</span><span class="p">:</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: unable to send </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_main_window_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Run after login to identify and store the main window handle that the handles for pop-up windows can be differentiated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_window_handle</span>

    <span class="k">def</span> <span class="nf">switch_to_secondary_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a secondary window as the current window in order to interact with the pop up.&quot;&quot;&quot;</span>
        <span class="n">new_window_handle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">handle</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span><span class="p">:</span>
                <span class="n">new_window_handle</span> <span class="o">=</span> <span class="n">handle</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">new_window_handle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">new_window_handle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is selected. If not selected then click it to select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">unselect_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is not selected. If selected then click it to un-select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">county_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Use the Nominatim geocode service via the geopy API to look up the county of a given town/city and state.&quot;&quot;&quot;</span>
        <span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;nbsbot&#39;</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">city</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
            <span class="n">county</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">location</span> <span class="k">if</span> <span class="s1">&#39;County&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">county</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="n">county</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">county</span>

    <span class="k">def</span> <span class="nf">zip_code_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">street</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Given a street address, city, and state use the USPS API via the usps</span>
<span class="sd">        Python package to lookup the associated zip code.&quot;&quot;&quot;</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">address_1</span><span class="o">=</span><span class="n">street</span><span class="p">,</span>
            <span class="n">city</span><span class="o">=</span><span class="n">city</span><span class="p">,</span>
            <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
            <span class="n">zipcode</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="p">)</span>
        <span class="n">usps</span> <span class="o">=</span> <span class="n">USPSApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validation</span> <span class="o">=</span> <span class="n">usps</span><span class="o">.</span><span class="n">validate_address</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;Address Not Found&#39;</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;AddressValidateResponse&#39;</span><span class="p">][</span><span class="s1">&#39;Address&#39;</span><span class="p">][</span><span class="s1">&#39;Zip5&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">zip_code</span>

    <span class="k">def</span> <span class="nf">check_for_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See if NBS encountered an error.&quot;&quot;&quot;</span>
        <span class="n">error_page_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[1]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">error_page_path</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">Error Page&#39;</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">nbs_error</span>

    <span class="k">def</span> <span class="nf">go_to_home_from_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page from an NBS error page. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>
</pre></div>

        </details>

            </section>
                <section id="NBSdriver">
                                <div class="attr class">
        <a class="headerlink" href="#NBSdriver">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">NBSdriver</span><wbr>(<span class="base">selenium.webdriver.chrome.webdriver.WebDriver</span>):
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">NBSdriver</span><span class="p">(</span><span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A class to provide basic functionality in NBS via Selenium. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">production</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">production</span> <span class="o">=</span> <span class="n">production</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_email_info</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_usps_user_id</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">production</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbs.iphis.maine.gov/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbstest.state.me.us/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;chromedriver.exe&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;log-level=3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-ssl-errors=yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NBSdriver</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">=</span> <span class="mi">3300</span> <span class="c1">#Value in seconds</span>


<span class="c1">########################### NBS Navigation Methods ############################</span>
    <span class="k">def</span> <span class="nf">get_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to prompt user to provide a valid username and RSA token</span>
<span class="sd">        to log in to NBS. Must &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your SOM username (&quot;first_name.last_name&quot;):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passcode</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your RSA passcode:&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Log in to NBS. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s2">&quot;contentFrame&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;passcode&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passcode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;/html/body/div[2]/p[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to specifc patient by NBS ID from Home. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;DEM229&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;patientSearchByDetails&quot;]/table[2]/tbody/tr[8]/td[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">search_result_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;searchResultsTable&quot;]/tbody/tr/td[1]/a&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clean_patient_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the leading and trailing characters from local patient</span>
<span class="sd">        ids to leave an id that is searchable in through the front end of NBS.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN1&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN2&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">patient_id</span>

    <span class="k">def</span> <span class="nf">go_to_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Summary tab.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head0&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within patient profile navigate to the Events tab. &quot;&quot;&quot;</span>
        <span class="n">events_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">error_encountered</span>

    <span class="k">def</span> <span class="nf">go_to_demographics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Demographics tab.&quot;&quot;&quot;</span>
        <span class="n">demographics_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">demographics_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page. &quot;&quot;&quot;</span>
        <span class="c1">#xpath = &#39;//*[@id=&quot;bd&quot;]/table[1]/tbody/tr/td[1]/table/tbody/tr/td[1]/a&#39;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Home&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1">#WebDriverWait(self,self.wait_before_timeout).until(EC.presence_of_element_located((By.XPATH, xpath)))</span>
                <span class="c1">#self.find_element(By.XPATH, xpath).click()</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">GoToApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to approval queue from Home page. &quot;&quot;&quot;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Approval Queue for Initial Notifications&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">ReturnApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return to Approval Queue from an investigation initally accessed from the queue. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">SortApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sort approval queue so that case are listed chronologically by</span>
<span class="sd">        notification creation date and in reverse alpha order so that</span>
<span class="sd">        &quot;2019 Novel...&quot; is at the top. &quot;&quot;&quot;</span>
        <span class="n">clear_filter_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;removeFilters&quot;]/a/font&#39;</span>
        <span class="n">submit_date_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[3]/a&#39;</span>
        <span class="n">condition_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[8]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Clear all filters</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click submit date for chronological order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click condition for reverse alpha order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">TimeoutException</span><span class="p">,</span> <span class="n">ElementClickInterceptedException</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">HandleBadQueueReturn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; When a request is sent to NBS to load or filter the approval queue</span>
<span class="sd">        and &quot;Nothing found to display&quot;, or anything other than the populated</span>
<span class="sd">        queue is returned, navigate back to the home page and request the queue</span>
<span class="sd">        again.&quot;&quot;&quot;</span>
        <span class="c1"># Recursion seems like a good idea here, but if the queue is truly empty there will be nothing to display and recursion will result in a stack overflow.</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">go_to_home</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GoToApprovalQueue</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load approval queue. Either to queue is truly empty, or a persistent issue with NBS was encountered.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">CheckFirstCase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure that first case is COVID and save case&#39;s name for later use.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[7]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">GoToFirstCaseInApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to first case in the approval queue. &quot;&quot;&quot;</span>
        <span class="n">xpath_to_case</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span>
        <span class="n">xpath_to_first_name</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;DEM104&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Make sure queue loads properly before navigating to first case.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Make sure first case loads properly before moving on.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_first_name</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GoToCaseInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the Case Info tab. &quot;&quot;&quot;</span>
        <span class="n">case_info_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span> <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GoToCOVID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the COVID tab. &quot;&quot;&quot;</span>
        <span class="n">covid_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to a lab from a patient profile navigate to a lab. &quot;&quot;&quot;</span>
        <span class="n">lab_report_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;lab1&quot;]&#39;</span>
        <span class="n">lab_report_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">lab_report_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab_report_table</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="n">lab_report_table</span><span class="p">[</span><span class="n">lab_report_table</span><span class="p">[</span><span class="s1">&#39;Event ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab_id</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lab_row_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr[</span><span class="si">{</span><span class="n">lab_row_index</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">lab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_investigation_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read the investigations table in the Events tab of a patient profile</span>
<span class="sd">        of all investigations on record, both open and closed.&quot;&quot;&quot;</span>
        <span class="n">investigation_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;inv1&quot;]&#39;</span>
        <span class="n">investigation_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">investigation_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
            <span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">investigation_table</span>

    <span class="k">def</span> <span class="nf">go_to_investigation_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an existing investigation based on its position in the</span>
<span class="sd">        Investigations table in the Events tab of a patient profile.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr[</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">existing_investigation_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_investigation_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an investigation with a given id from a patient profile.&quot;&quot;&quot;</span>
        <span class="n">inv_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_investigation_table</span><span class="p">()</span>
        <span class="n">inv_row</span> <span class="o">=</span> <span class="n">inv_table</span><span class="p">[</span><span class="n">inv_table</span><span class="p">[</span><span class="s1">&#39;Investigation ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">inv_id</span><span class="p">]</span>
        <span class="n">inv_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inv_row</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">go_to_investigation_by_index</span><span class="p">(</span><span class="n">inv_index</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within an investigation.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within a lab report.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;doc3&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">click_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button to save changes.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">click_manage_associations_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button in the Manage Associations window.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/div/table[2]/tbody/tr/td/table/tbody/tr/td[2]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">enter_edit_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From within an investigation click the edit button to enter edit mode.&quot;&quot;&quot;</span>
        <span class="n">edit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">edit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">click_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click cancel.&quot;&quot;&quot;</span>
        <span class="n">cancel_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;Cancel&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">cancel_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">go_to_manage_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click button to navigate to the Manage Associations page from an investigation.&quot;&quot;&quot;</span>
        <span class="n">manage_associations_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;manageAssociations&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">manage_associations_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>
<span class="c1">############################# Data Reading/Validation Methods ##################################</span>

    <span class="k">def</span> <span class="nf">CheckForValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">blank_message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If value is blank add appropriate message to list of issues. &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blank_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">check_for_value_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return boolean value based on whether a value is present.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">check</span>

    <span class="k">def</span> <span class="nf">ReadDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;innerText&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read date from NBS and return a datetime.date object. &quot;&quot;&quot;</span>
        <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">date</span>

    <span class="k">def</span> <span class="nf">CheckIfField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If parent field is value ensure that child field is not blank. &quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ReadText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read the text of any web element identified by an Xpath</span>
<span class="sd">        and remove leading an trailing carriage returns sometimes included by</span>
<span class="sd">        Selenium&#39;s get_attribute(&#39;innerText&#39;).&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">ReadTableToDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read tables into pandas Data Frames for easy manipulation. &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">table</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">table</span>

    <span class="k">def</span> <span class="nf">ReadPatientID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read patient ID from within patient profile. &quot;&quot;&quot;</span>
        <span class="n">patient_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="s1">&#39;//*[@id=&quot;bd&quot;]/table[3]/tbody/tr[1]/td[2]/span[2]&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">patient_id</span>

    <span class="k">def</span> <span class="nf">Sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pause all action for the specified number of seconds. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span><span class="p">):</span>
            <span class="n">time_remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">-</span> <span class="n">i</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sleeping for: </span><span class="si">{</span><span class="n">time_remaining</span><span class="o">//</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">time_remaining</span><span class="o">%</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sleeping for: 00:00&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_email_local_outlook_client</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">attachment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send an email using local Outlook client.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_gen_py</span><span class="p">()</span>
        <span class="n">outlook</span> <span class="o">=</span> <span class="n">win32</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;outlook.application&#39;</span><span class="p">)</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">outlook</span><span class="o">.</span><span class="n">CreateItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">GetInspector</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">To</span> <span class="o">=</span> <span class="n">recipient</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">CC</span> <span class="o">=</span> <span class="n">cc</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Subject</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Body</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">if</span> <span class="n">attachment</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mail</span><span class="o">.</span><span class="n">Attachments</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Send</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">clear_gen_py</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear the contents of the the gen_py directory to ensure emails can</span>
<span class="sd">        always be sent.&quot;&quot;&quot;</span>
        <span class="c1"># Construct to path gen_py directory if it exists.</span>
        <span class="n">current_user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">current_user</span> <span class="o">+</span> <span class="s1">&#39;\AppData\Local\Temp\gen_py&#39;</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>

        <span class="c1"># If gen_py exists delete it and all contents.</span>
        <span class="k">if</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">read_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read in data from config.cfg&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;config.cfg&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_email_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read information required for NBSbot to send emails via an smtp</span>
<span class="sd">        server to various email lists.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;smtp_server&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;nbsbot_email&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_informatics_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_informatics_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_admin_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_admin_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_commander</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_commander&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_usps_user_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Extract the USPS User ID from the config file for later use in the</span>
<span class="sd">        zip_code_lookup() method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;usps&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">send_smtp_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">email_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send emails using an SMTP server &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">EmailMessage</span><span class="p">()</span>
        <span class="n">message</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">receiver</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
           <span class="n">smtpObj</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span><span class="p">)</span>
           <span class="n">smtpObj</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully sent </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SMTPException</span><span class="p">:</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: unable to send </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_main_window_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Run after login to identify and store the main window handle that the handles for pop-up windows can be differentiated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_window_handle</span>

    <span class="k">def</span> <span class="nf">switch_to_secondary_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a secondary window as the current window in order to interact with the pop up.&quot;&quot;&quot;</span>
        <span class="n">new_window_handle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">handle</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span><span class="p">:</span>
                <span class="n">new_window_handle</span> <span class="o">=</span> <span class="n">handle</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">new_window_handle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">new_window_handle</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">select_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is selected. If not selected then click it to select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">unselect_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is not selected. If selected then click it to un-select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">county_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Use the Nominatim geocode service via the geopy API to look up the county of a given town/city and state.&quot;&quot;&quot;</span>
        <span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;nbsbot&#39;</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">city</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
            <span class="n">county</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">location</span> <span class="k">if</span> <span class="s1">&#39;County&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">county</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="n">county</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">county</span>

    <span class="k">def</span> <span class="nf">zip_code_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">street</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Given a street address, city, and state use the USPS API via the usps</span>
<span class="sd">        Python package to lookup the associated zip code.&quot;&quot;&quot;</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">address_1</span><span class="o">=</span><span class="n">street</span><span class="p">,</span>
            <span class="n">city</span><span class="o">=</span><span class="n">city</span><span class="p">,</span>
            <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
            <span class="n">zipcode</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="p">)</span>
        <span class="n">usps</span> <span class="o">=</span> <span class="n">USPSApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validation</span> <span class="o">=</span> <span class="n">usps</span><span class="o">.</span><span class="n">validate_address</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;Address Not Found&#39;</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;AddressValidateResponse&#39;</span><span class="p">][</span><span class="s1">&#39;Address&#39;</span><span class="p">][</span><span class="s1">&#39;Zip5&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">zip_code</span>

    <span class="k">def</span> <span class="nf">check_for_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See if NBS encountered an error.&quot;&quot;&quot;</span>
        <span class="n">error_page_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[1]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">error_page_path</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">Error Page&#39;</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">nbs_error</span>

    <span class="k">def</span> <span class="nf">go_to_home_from_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page from an NBS error page. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>A class to provide basic functionality in NBS via Selenium.</p>
</div>


                            <div id="NBSdriver.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">NBSdriver</span><span class="signature">(production=False)</span>
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">production</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">production</span> <span class="o">=</span> <span class="n">production</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_config</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_email_info</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_usps_user_id</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">production</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbs.iphis.maine.gov/&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;https://nbstest.state.me.us/&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;chromedriver.exe&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;log-level=3&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-ssl-errors=yes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ignore-certificate-errors&#39;</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NBSdriver</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">executable_path</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">issues</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span> <span class="o">=</span> <span class="mi">30</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">=</span> <span class="mi">3300</span> <span class="c1">#Value in seconds</span>
</pre></div>

        </details>

            <div class="docstring"><p>Creates a new instance of the chrome driver.
Starts the service and then creates new instance of chrome driver.</p>

<p>:Args:</p>

<ul>
<li>executable_path - Deprecated: path to the executable. If the default is used it assumes the executable is in the $PATH</li>
<li>port - Deprecated: port you would like the service to run, if left as 0, a free port will be found.</li>
<li>options - this takes an instance of ChromeOptions</li>
<li>service - Service object for handling the browser driver if you need to pass extra details</li>
<li>service_args - Deprecated: List of args to pass to the driver service</li>
<li>desired_capabilities - Deprecated: Dictionary object with non-browser specific
capabilities only, such as "proxy" or "loggingPref".</li>
<li>service_log_path - Deprecated: Where to log information from the driver.</li>
<li>keep_alive - Deprecated: Whether to configure ChromeRemoteConnection to use HTTP keep-alive.</li>
</ul>
</div>


                            </div>
                            <div id="NBSdriver.get_credentials" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.get_credentials">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_credentials</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to prompt user to provide a valid username and RSA token</span>
<span class="sd">        to log in to NBS. Must &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your SOM username (&quot;first_name.last_name&quot;):&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">passcode</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter your RSA passcode:&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>A method to prompt user to provide a valid username and RSA token
to log in to NBS. Must</p>
</div>


                            </div>
                            <div id="NBSdriver.log_in" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.log_in">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">log_in</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">log_in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Log in to NBS. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">site</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="s2">&quot;contentFrame&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s1">&#39;passcode&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">passcode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;/html/body/div[2]/p[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;bea-portal-window-content-4&quot;]/tr/td/h2[4]/font/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Log in to NBS.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_id">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_id</span><span class="signature">(self, id)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to specifc patient by NBS ID from Home. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;DEM229&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;patientSearchByDetails&quot;]/table[2]/tbody/tr[8]/td[2]/input[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="n">search_result_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;searchResultsTable&quot;]/tbody/tr/td[1]/a&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">search_result_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to specifc patient by NBS ID from Home.</p>
</div>


                            </div>
                            <div id="NBSdriver.clean_patient_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.clean_patient_id">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">clean_patient_id</span><span class="signature">(self, patient_id)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">clean_patient_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove the leading and trailing characters from local patient</span>
<span class="sd">        ids to leave an id that is searchable in through the front end of NBS.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN1&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PSN2&#39;</span><span class="p">:</span>
            <span class="n">patient_id</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span class="o">+</span> <span class="n">patient_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">patient_id</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove the leading and trailing characters from local patient
ids to leave an id that is searchable in through the front end of NBS.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_summary" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_summary">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_summary</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Summary tab.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head0&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Within a patient profile navigate to the Summary tab.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_events" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_events">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_events</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within patient profile navigate to the Events tab. &quot;&quot;&quot;</span>
        <span class="n">events_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">events_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="n">error_encountered</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">error_encountered</span>
</pre></div>

        </details>

            <div class="docstring"><p>Within patient profile navigate to the Events tab.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_demographics" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_demographics">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_demographics</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_demographics</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a patient profile navigate to the Demographics tab.&quot;&quot;&quot;</span>
        <span class="n">demographics_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">demographics_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Within a patient profile navigate to the Demographics tab.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_home" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_home">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_home</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_home</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page. &quot;&quot;&quot;</span>
        <span class="c1">#xpath = &#39;//*[@id=&quot;bd&quot;]/table[1]/tbody/tr/td[1]/table/tbody/tr/td[1]/a&#39;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Home&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1">#WebDriverWait(self,self.wait_before_timeout).until(EC.presence_of_element_located((By.XPATH, xpath)))</span>
                <span class="c1">#self.find_element(By.XPATH, xpath).click()</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Go to NBS Home page.</p>
</div>


                            </div>
                            <div id="NBSdriver.GoToApprovalQueue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.GoToApprovalQueue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">GoToApprovalQueue</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">GoToApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to approval queue from Home page. &quot;&quot;&quot;</span>
        <span class="n">partial_link</span> <span class="o">=</span> <span class="s1">&#39;Approval Queue for Initial Notifications&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">PARTIAL_LINK_TEXT</span><span class="p">,</span> <span class="n">partial_link</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to approval queue from Home page.</p>
</div>


                            </div>
                            <div id="NBSdriver.ReturnApprovalQueue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.ReturnApprovalQueue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ReturnApprovalQueue</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">ReturnApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return to Approval Queue from an investigation initally accessed from the queue. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return to Approval Queue from an investigation initally accessed from the queue.</p>
</div>


                            </div>
                            <div id="NBSdriver.SortApprovalQueue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.SortApprovalQueue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">SortApprovalQueue</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">SortApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Sort approval queue so that case are listed chronologically by</span>
<span class="sd">        notification creation date and in reverse alpha order so that</span>
<span class="sd">        &quot;2019 Novel...&quot; is at the top. &quot;&quot;&quot;</span>
        <span class="n">clear_filter_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;removeFilters&quot;]/a/font&#39;</span>
        <span class="n">submit_date_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[3]/a&#39;</span>
        <span class="n">condition_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/thead/tr/th[8]/a&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Clear all filters</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">clear_filter_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click submit date for chronological order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_date_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Double click condition for reverse alpha order.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">condition_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">condition_path</span><span class="p">)))</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">TimeoutException</span><span class="p">,</span> <span class="n">ElementClickInterceptedException</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Sort approval queue so that case are listed chronologically by
notification creation date and in reverse alpha order so that
"2019 Novel..." is at the top.</p>
</div>


                            </div>
                            <div id="NBSdriver.HandleBadQueueReturn" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.HandleBadQueueReturn">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">HandleBadQueueReturn</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">HandleBadQueueReturn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; When a request is sent to NBS to load or filter the approval queue</span>
<span class="sd">        and &quot;Nothing found to display&quot;, or anything other than the populated</span>
<span class="sd">        queue is returned, navigate back to the home page and request the queue</span>
<span class="sd">        again.&quot;&quot;&quot;</span>
        <span class="c1"># Recursion seems like a good idea here, but if the queue is truly empty there will be nothing to display and recursion will result in a stack overflow.</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">go_to_home</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GoToApprovalQueue</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue_loaded</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load approval queue. Either to queue is truly empty, or a persistent issue with NBS was encountered.&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>When a request is sent to NBS to load or filter the approval queue
and "Nothing found to display", or anything other than the populated
queue is returned, navigate back to the home page and request the queue
again.</p>
</div>


                            </div>
                            <div id="NBSdriver.CheckFirstCase" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.CheckFirstCase">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">CheckFirstCase</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">CheckFirstCase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure that first case is COVID and save case&#39;s name for later use.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[7]/a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patient_name</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Ensure that first case is COVID and save case's name for later use.</p>
</div>


                            </div>
                            <div id="NBSdriver.GoToFirstCaseInApprovalQueue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.GoToFirstCaseInApprovalQueue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">GoToFirstCaseInApprovalQueue</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">GoToFirstCaseInApprovalQueue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to first case in the approval queue. &quot;&quot;&quot;</span>
        <span class="n">xpath_to_case</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;parent&quot;]/tbody/tr[1]/td[8]/a&#39;</span>
        <span class="n">xpath_to_first_name</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;DEM104&quot;]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Make sure queue loads properly before navigating to first case.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_case</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
            <span class="c1"># Make sure first case loads properly before moving on.</span>
            <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath_to_first_name</span><span class="p">)))</span>
        <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HandleBadQueueReturn</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to first case in the approval queue.</p>
</div>


                            </div>
                            <div id="NBSdriver.GoToCaseInfo" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.GoToCaseInfo">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">GoToCaseInfo</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">GoToCaseInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the Case Info tab. &quot;&quot;&quot;</span>
        <span class="n">case_info_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head1&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">case_info_tab_path</span> <span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Within a COVID investigation navigate to the Case Info tab.</p>
</div>


                            </div>
                            <div id="NBSdriver.GoToCOVID" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.GoToCOVID">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">GoToCOVID</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">GoToCOVID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Within a COVID investigation navigate to the COVID tab. &quot;&quot;&quot;</span>
        <span class="n">covid_tab_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;tabs0head2&quot;]&#39;</span>
        <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">covid_tab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Within a COVID investigation navigate to the COVID tab.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_lab" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_lab">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_lab</span><span class="signature">(self, lab_id)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Navigate to a lab from a patient profile navigate to a lab. &quot;&quot;&quot;</span>
        <span class="n">lab_report_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;lab1&quot;]&#39;</span>
        <span class="n">lab_report_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">lab_report_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab_report_table</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="n">lab_report_table</span><span class="p">[</span><span class="n">lab_report_table</span><span class="p">[</span><span class="s1">&#39;Event ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab_id</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">lab_row_index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lab_row_index</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr[</span><span class="si">{</span><span class="n">lab_row_index</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lab_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[5]/div/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span><span class="n">lab_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to a lab from a patient profile navigate to a lab.</p>
</div>


                            </div>
                            <div id="NBSdriver.read_investigation_table" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.read_investigation_table">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">read_investigation_table</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">read_investigation_table</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read the investigations table in the Events tab of a patient profile</span>
<span class="sd">        of all investigations on record, both open and closed.&quot;&quot;&quot;</span>
        <span class="n">investigation_table_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;inv1&quot;]&#39;</span>
        <span class="n">investigation_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadTableToDF</span><span class="p">(</span><span class="n">investigation_table_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">)</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
            <span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">investigation_table</span><span class="p">[</span><span class="s1">&#39;Start Date&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">investigation_table</span>
</pre></div>

        </details>

            <div class="docstring"><p>Read the investigations table in the Events tab of a patient profile
of all investigations on record, both open and closed.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_investigation_by_index" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_investigation_by_index">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_investigation_by_index</span><span class="signature">(self, index)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_investigation_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an existing investigation based on its position in the</span>
<span class="sd">        Investigations table in the Events tab of a patient profile.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr[</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="si">}</span><span class="s1">]/td[1]/a&#39;</span>
        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">existing_investigation_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/html/body/div[2]/form/div/table[4]/tbody/tr[2]/td/div[2]/table/tbody/tr/td/div[1]/div[3]/div/table/tbody/tr[2]/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">existing_investigation_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to an existing investigation based on its position in the
Investigations table in the Events tab of a patient profile.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_investigation_by_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_investigation_by_id">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_investigation_by_id</span><span class="signature">(self, inv_id)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_investigation_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inv_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Navigate to an investigation with a given id from a patient profile.&quot;&quot;&quot;</span>
        <span class="n">inv_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_investigation_table</span><span class="p">()</span>
        <span class="n">inv_row</span> <span class="o">=</span> <span class="n">inv_table</span><span class="p">[</span><span class="n">inv_table</span><span class="p">[</span><span class="s1">&#39;Investigation ID&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">inv_id</span><span class="p">]</span>
        <span class="n">inv_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">inv_row</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">go_to_investigation_by_index</span><span class="p">(</span><span class="n">inv_index</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Navigate to an investigation with a given id from a patient profile.</p>
</div>


                            </div>
                            <div id="NBSdriver.return_to_patient_profile_from_inv" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.return_to_patient_profile_from_inv">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">return_to_patient_profile_from_inv</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within an investigation.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;bd&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Go back to the patient profile from within an investigation.</p>
</div>


                            </div>
                            <div id="NBSdriver.return_to_patient_profile_from_lab" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.return_to_patient_profile_from_lab">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">return_to_patient_profile_from_lab</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">return_to_patient_profile_from_lab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go back to the patient profile from within a lab report.&quot;&quot;&quot;</span>
        <span class="n">return_to_file_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;doc3&quot;]/div[1]/a&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">return_to_file_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Go back to the patient profile from within a lab report.</p>
</div>


                            </div>
                            <div id="NBSdriver.click_submit" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.click_submit">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">click_submit</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">click_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button to save changes.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Click submit button to save changes.</p>
</div>


                            </div>
                            <div id="NBSdriver.click_manage_associations_submit" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.click_manage_associations_submit">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">click_manage_associations_submit</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">click_manage_associations_submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click submit button in the Manage Associations window.&quot;&quot;&quot;</span>
        <span class="n">submit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div[2]/div/table[2]/tbody/tr/td/table/tbody/tr/td[2]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">submit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Click submit button in the Manage Associations window.</p>
</div>


                            </div>
                            <div id="NBSdriver.enter_edit_mode" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.enter_edit_mode">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">enter_edit_mode</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">enter_edit_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From within an investigation click the edit button to enter edit mode.&quot;&quot;&quot;</span>
        <span class="n">edit_button_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/div/div/form/div[2]/div[1]/table[2]/tbody/tr/td[2]/table/tbody/tr/td[1]/input&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">edit_button_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>From within an investigation click the edit button to enter edit mode.</p>
</div>


                            </div>
                            <div id="NBSdriver.click_cancel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.click_cancel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">click_cancel</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">click_cancel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click cancel.&quot;&quot;&quot;</span>
        <span class="n">cancel_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;Cancel&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">cancel_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Click cancel.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_manage_associations" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_manage_associations">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_manage_associations</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_manage_associations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Click button to navigate to the Manage Associations page from an investigation.&quot;&quot;&quot;</span>
        <span class="n">manage_associations_path</span> <span class="o">=</span> <span class="s1">&#39;//*[@id=&quot;manageAssociations&quot;]&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">manage_associations_path</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">alert</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">NoAlertPresentException</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Click button to navigate to the Manage Associations page from an investigation.</p>
</div>


                            </div>
                            <div id="NBSdriver.CheckForValue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.CheckForValue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">CheckForValue</span><span class="signature">(self, xpath, blank_message)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">CheckForValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">blank_message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If value is blank add appropriate message to list of issues. &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blank_message</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>
</pre></div>

        </details>

            <div class="docstring"><p>If value is blank add appropriate message to list of issues.</p>
</div>


                            </div>
                            <div id="NBSdriver.check_for_value_bool" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.check_for_value_bool">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_for_value_bool</span><span class="signature">(self, path)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_for_value_bool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return boolean value based on whether a value is present.&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">check</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return boolean value based on whether a value is present.</p>
</div>


                            </div>
                            <div id="NBSdriver.ReadDate" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.ReadDate">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ReadDate</span><span class="signature">(self, xpath, attribute=&#39;innerText&#39;)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">ReadDate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="s1">&#39;innerText&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read date from NBS and return a datetime.date object. &quot;&quot;&quot;</span>
        <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%m/</span><span class="si">%d</span><span class="s1">/%Y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">date</span>
</pre></div>

        </details>

            <div class="docstring"><p>Read date from NBS and return a datetime.date object.</p>
</div>


                            </div>
                            <div id="NBSdriver.CheckIfField" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.CheckIfField">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">CheckIfField</span><span class="signature">(self, parent_xpath, child_xpath, value, message)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">CheckIfField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; If parent field is value ensure that child field is not blank. &quot;&quot;&quot;</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">parent_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parent</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">child_xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">child</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">issues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>If parent field is value ensure that child field is not blank.</p>
</div>


                            </div>
                            <div id="NBSdriver.ReadText" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.ReadText">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ReadText</span><span class="signature">(self, xpath)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">ReadText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read the text of any web element identified by an Xpath</span>
<span class="sd">        and remove leading an trailing carriage returns sometimes included by</span>
<span class="sd">        Selenium&#39;s get_attribute(&#39;innerText&#39;).&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerText&#39;</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>
</pre></div>

        </details>

            <div class="docstring"><p>A method to read the text of any web element identified by an Xpath
and remove leading an trailing carriage returns sometimes included by
Selenium's get_attribute('innerText').</p>
</div>


                            </div>
                            <div id="NBSdriver.ReadTableToDF" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.ReadTableToDF">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ReadTableToDF</span><span class="signature">(self, xpath)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">ReadTableToDF</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; A method to read tables into pandas Data Frames for easy manipulation. &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s1">&#39;innerHTML&#39;</span><span class="p">)</span>
            <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;html.parser&#39;</span><span class="p">)</span>
            <span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">soup</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">table</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">table</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">table</span>
</pre></div>

        </details>

            <div class="docstring"><p>A method to read tables into pandas Data Frames for easy manipulation.</p>
</div>


                            </div>
                            <div id="NBSdriver.ReadPatientID" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.ReadPatientID">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">ReadPatientID</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">ReadPatientID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read patient ID from within patient profile. &quot;&quot;&quot;</span>
        <span class="n">patient_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="s1">&#39;//*[@id=&quot;bd&quot;]/table[3]/tbody/tr[1]/td[2]/span[2]&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">patient_id</span>
</pre></div>

        </details>

            <div class="docstring"><p>Read patient ID from within patient profile.</p>
</div>


                            </div>
                            <div id="NBSdriver.Sleep" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.Sleep">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">Sleep</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">Sleep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Pause all action for the specified number of seconds. &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span><span class="p">):</span>
            <span class="n">time_remaining</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sleep_duration</span> <span class="o">-</span> <span class="n">i</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sleeping for: </span><span class="si">{</span><span class="n">time_remaining</span><span class="o">//</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">time_remaining</span><span class="o">%</span><span class="mi">60</span><span class="si">:</span><span class="s1">02d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Sleeping for: 00:00&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Pause all action for the specified number of seconds.</p>
</div>


                            </div>
                            <div id="NBSdriver.send_email_local_outlook_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.send_email_local_outlook_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">send_email_local_outlook_client</span><span class="signature">(self, recipient, cc, subject, message, attachment=None)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">send_email_local_outlook_client</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recipient</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">attachment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send an email using local Outlook client.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_gen_py</span><span class="p">()</span>
        <span class="n">outlook</span> <span class="o">=</span> <span class="n">win32</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s1">&#39;outlook.application&#39;</span><span class="p">)</span>
        <span class="n">mail</span> <span class="o">=</span> <span class="n">outlook</span><span class="o">.</span><span class="n">CreateItem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">GetInspector</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">To</span> <span class="o">=</span> <span class="n">recipient</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">CC</span> <span class="o">=</span> <span class="n">cc</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Subject</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Body</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">if</span> <span class="n">attachment</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mail</span><span class="o">.</span><span class="n">Attachments</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">attachment</span><span class="p">)</span>
        <span class="n">mail</span><span class="o">.</span><span class="n">Send</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Send an email using local Outlook client.</p>
</div>


                            </div>
                            <div id="NBSdriver.clear_gen_py" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.clear_gen_py">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">clear_gen_py</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">clear_gen_py</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Clear the contents of the the gen_py directory to ensure emails can</span>
<span class="sd">        always be sent.&quot;&quot;&quot;</span>
        <span class="c1"># Construct to path gen_py directory if it exists.</span>
        <span class="n">current_user</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users&#39;</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">current_user</span> <span class="o">+</span> <span class="s1">&#39;\AppData\Local\Temp\gen_py&#39;</span>
        <span class="n">gen_py_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>

        <span class="c1"># If gen_py exists delete it and all contents.</span>
        <span class="k">if</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="n">gen_py_path</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="n">rmtree</span><span class="p">(</span><span class="n">gen_py_path</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Clear the contents of the the gen_py directory to ensure emails can
always be sent.</p>
</div>


                            </div>
                            <div id="NBSdriver.read_config" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.read_config">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">read_config</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">read_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read in data from config.cfg&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;config.cfg&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Read in data from config.cfg</p>
</div>


                            </div>
                            <div id="NBSdriver.get_email_info" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.get_email_info">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_email_info</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_email_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Read information required for NBSbot to send emails via an smtp</span>
<span class="sd">        server to various email lists.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;smtp_server&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;nbsbot_email&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_informatics_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_informatics_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_admin_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_admin_list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">covid_commander</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;covid_commander&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Read information required for NBSbot to send emails via an smtp
server to various email lists.</p>
</div>


                            </div>
                            <div id="NBSdriver.get_usps_user_id" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.get_usps_user_id">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_usps_user_id</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_usps_user_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Extract the USPS User ID from the config file for later use in the</span>
<span class="sd">        zip_code_lookup() method.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;usps&#39;</span><span class="p">,</span> <span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Extract the USPS User ID from the config file for later use in the
zip_code_lookup() method.</p>
</div>


                            </div>
                            <div id="NBSdriver.send_smtp_email" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.send_smtp_email">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">send_smtp_email</span><span class="signature">(self, receiver, subject, body, email_name)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">send_smtp_email</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">email_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send emails using an SMTP server &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">EmailMessage</span><span class="p">()</span>
        <span class="n">message</span><span class="o">.</span><span class="n">set_content</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbsbot_email</span>
        <span class="n">message</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">receiver</span><span class="p">])</span>
        <span class="k">try</span><span class="p">:</span>
           <span class="n">smtpObj</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smtp_server</span><span class="p">)</span>
           <span class="n">smtpObj</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully sent </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SMTPException</span><span class="p">:</span>
           <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: unable to send </span><span class="si">{</span><span class="n">email_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Send emails using an SMTP server</p>
</div>


                            </div>
                            <div id="NBSdriver.get_main_window_handle" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.get_main_window_handle">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_main_window_handle</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">get_main_window_handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Run after login to identify and store the main window handle that the handles for pop-up windows can be differentiated.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_window_handle</span>
</pre></div>

        </details>

            <div class="docstring"><p>Run after login to identify and store the main window handle that the handles for pop-up windows can be differentiated.</p>
</div>


                            </div>
                            <div id="NBSdriver.switch_to_secondary_window" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.switch_to_secondary_window">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">switch_to_secondary_window</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">switch_to_secondary_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Set a secondary window as the current window in order to interact with the pop up.&quot;&quot;&quot;</span>
        <span class="n">new_window_handle</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">window_handles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">handle</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_window_handle</span><span class="p">:</span>
                <span class="n">new_window_handle</span> <span class="o">=</span> <span class="n">handle</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">new_window_handle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">new_window_handle</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Set a secondary window as the current window in order to interact with the pop up.</p>
</div>


                            </div>
                            <div id="NBSdriver.select_checkbox" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.select_checkbox">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">select_checkbox</span><span class="signature">(self, xpath)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">select_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is selected. If not selected then click it to select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Ensure the a given checkbox or radio button is selected. If not selected then click it to select.</p>
</div>


                            </div>
                            <div id="NBSdriver.unselect_checkbox" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.unselect_checkbox">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">unselect_checkbox</span><span class="signature">(self, xpath)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">unselect_checkbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xpath</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Ensure the a given checkbox or radio button is not selected. If selected then click it to un-select.&quot;&quot;&quot;</span>
        <span class="n">checkbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checkbox</span><span class="o">.</span><span class="n">is_selected</span><span class="p">():</span>
            <span class="n">checkbox</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Ensure the a given checkbox or radio button is not selected. If selected then click it to un-select.</p>
</div>


                            </div>
                            <div id="NBSdriver.county_lookup" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.county_lookup">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">county_lookup</span><span class="signature">(self, city, state)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">county_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Use the Nominatim geocode service via the geopy API to look up the county of a given town/city and state.&quot;&quot;&quot;</span>
        <span class="n">geolocator</span> <span class="o">=</span> <span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;nbsbot&#39;</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">geolocator</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">city</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="n">state</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">location</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
            <span class="n">county</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">location</span> <span class="k">if</span> <span class="s1">&#39;County&#39;</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">county</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="n">county</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">county</span>
</pre></div>

        </details>

            <div class="docstring"><p>Use the Nominatim geocode service via the geopy API to look up the county of a given town/city and state.</p>
</div>


                            </div>
                            <div id="NBSdriver.zip_code_lookup" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.zip_code_lookup">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">zip_code_lookup</span><span class="signature">(self, street, city, state)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">zip_code_lookup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">street</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Given a street address, city, and state use the USPS API via the usps</span>
<span class="sd">        Python package to lookup the associated zip code.&quot;&quot;&quot;</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">address_1</span><span class="o">=</span><span class="n">street</span><span class="p">,</span>
            <span class="n">city</span><span class="o">=</span><span class="n">city</span><span class="p">,</span>
            <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
            <span class="n">zipcode</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="p">)</span>
        <span class="n">usps</span> <span class="o">=</span> <span class="n">USPSApi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usps_user_id</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validation</span> <span class="o">=</span> <span class="n">usps</span><span class="o">.</span><span class="n">validate_address</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;Address Not Found&#39;</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">):</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="n">validation</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;AddressValidateResponse&#39;</span><span class="p">][</span><span class="s1">&#39;Address&#39;</span><span class="p">][</span><span class="s1">&#39;Zip5&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">zip_code</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">return</span> <span class="n">zip_code</span>
</pre></div>

        </details>

            <div class="docstring"><p>Given a street address, city, and state use the USPS API via the usps
Python package to lookup the associated zip code.</p>
</div>


                            </div>
                            <div id="NBSdriver.check_for_error_page" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.check_for_error_page">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">check_for_error_page</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">check_for_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; See if NBS encountered an error.&quot;&quot;&quot;</span>
        <span class="n">error_page_path</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[2]/td/table/tbody/tr/td/table/tbody/tr[2]/td[1]&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadText</span><span class="p">(</span><span class="n">error_page_path</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">Error Page&#39;</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">nbs_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">nbs_error</span>
</pre></div>

        </details>

            <div class="docstring"><p>See if NBS encountered an error.</p>
</div>


                            </div>
                            <div id="NBSdriver.go_to_home_from_error_page" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#NBSdriver.go_to_home_from_error_page">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">go_to_home_from_error_page</span><span class="signature">(self)</span>:
    </div>

                <details>
            <summary>View Source</summary>
            <div class="codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">go_to_home_from_error_page</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Go to NBS Home page from an NBS error page. &quot;&quot;&quot;</span>
        <span class="n">xpath</span> <span class="o">=</span> <span class="s1">&#39;/html/body/table/tbody/tr/td/table/tbody/tr[1]/td/table/tbody/tr/td/table/tbody/tr/td[1]/a&#39;</span>
        <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">WebDriverWait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">wait_before_timeout</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="n">xpath</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">TimeoutException</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_loaded</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Made </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">num_attempts</span><span class="si">}</span><span class="s2"> unsuccessful attempts to load Home page. A persistent issue with NBS was encountered.&quot;</span><span class="p">))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Go to NBS Home page from an NBS error page.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>selenium.webdriver.chromium.webdriver.ChromiumDriver</dt>
                                <dd id="NBSdriver.launch_app" class="function">launch_app</dd>
                <dd id="NBSdriver.get_network_conditions" class="function">get_network_conditions</dd>
                <dd id="NBSdriver.set_network_conditions" class="function">set_network_conditions</dd>
                <dd id="NBSdriver.delete_network_conditions" class="function">delete_network_conditions</dd>
                <dd id="NBSdriver.set_permissions" class="function">set_permissions</dd>
                <dd id="NBSdriver.execute_cdp_cmd" class="function">execute_cdp_cmd</dd>
                <dd id="NBSdriver.get_sinks" class="function">get_sinks</dd>
                <dd id="NBSdriver.get_issue_message" class="function">get_issue_message</dd>
                <dd id="NBSdriver.set_sink_to_use" class="function">set_sink_to_use</dd>
                <dd id="NBSdriver.start_tab_mirroring" class="function">start_tab_mirroring</dd>
                <dd id="NBSdriver.stop_casting" class="function">stop_casting</dd>
                <dd id="NBSdriver.quit" class="function">quit</dd>
                <dd id="NBSdriver.create_options" class="function">create_options</dd>

            </div>
            <div><dt>selenium.webdriver.remote.webdriver.WebDriver</dt>
                                <dd id="NBSdriver.file_detector" class="variable">file_detector</dd>
                <dd id="NBSdriver.file_detector_context" class="function">file_detector_context</dd>
                <dd id="NBSdriver.mobile" class="variable">mobile</dd>
                <dd id="NBSdriver.name" class="variable">name</dd>
                <dd id="NBSdriver.start_client" class="function">start_client</dd>
                <dd id="NBSdriver.stop_client" class="function">stop_client</dd>
                <dd id="NBSdriver.start_session" class="function">start_session</dd>
                <dd id="NBSdriver.create_web_element" class="function">create_web_element</dd>
                <dd id="NBSdriver.execute" class="function">execute</dd>
                <dd id="NBSdriver.get" class="function">get</dd>
                <dd id="NBSdriver.title" class="variable">title</dd>
                <dd id="NBSdriver.find_element_by_id" class="function">find_element_by_id</dd>
                <dd id="NBSdriver.find_elements_by_id" class="function">find_elements_by_id</dd>
                <dd id="NBSdriver.find_element_by_xpath" class="function">find_element_by_xpath</dd>
                <dd id="NBSdriver.find_elements_by_xpath" class="function">find_elements_by_xpath</dd>
                <dd id="NBSdriver.find_element_by_link_text" class="function">find_element_by_link_text</dd>
                <dd id="NBSdriver.find_elements_by_link_text" class="function">find_elements_by_link_text</dd>
                <dd id="NBSdriver.find_element_by_partial_link_text" class="function">find_element_by_partial_link_text</dd>
                <dd id="NBSdriver.find_elements_by_partial_link_text" class="function">find_elements_by_partial_link_text</dd>
                <dd id="NBSdriver.find_element_by_name" class="function">find_element_by_name</dd>
                <dd id="NBSdriver.find_elements_by_name" class="function">find_elements_by_name</dd>
                <dd id="NBSdriver.find_element_by_tag_name" class="function">find_element_by_tag_name</dd>
                <dd id="NBSdriver.find_elements_by_tag_name" class="function">find_elements_by_tag_name</dd>
                <dd id="NBSdriver.find_element_by_class_name" class="function">find_element_by_class_name</dd>
                <dd id="NBSdriver.find_elements_by_class_name" class="function">find_elements_by_class_name</dd>
                <dd id="NBSdriver.find_element_by_css_selector" class="function">find_element_by_css_selector</dd>
                <dd id="NBSdriver.find_elements_by_css_selector" class="function">find_elements_by_css_selector</dd>
                <dd id="NBSdriver.pin_script" class="function">pin_script</dd>
                <dd id="NBSdriver.unpin" class="function">unpin</dd>
                <dd id="NBSdriver.get_pinned_scripts" class="function">get_pinned_scripts</dd>
                <dd id="NBSdriver.execute_script" class="function">execute_script</dd>
                <dd id="NBSdriver.execute_async_script" class="function">execute_async_script</dd>
                <dd id="NBSdriver.current_url" class="variable">current_url</dd>
                <dd id="NBSdriver.page_source" class="variable">page_source</dd>
                <dd id="NBSdriver.close" class="function">close</dd>
                <dd id="NBSdriver.current_window_handle" class="variable">current_window_handle</dd>
                <dd id="NBSdriver.window_handles" class="variable">window_handles</dd>
                <dd id="NBSdriver.maximize_window" class="function">maximize_window</dd>
                <dd id="NBSdriver.fullscreen_window" class="function">fullscreen_window</dd>
                <dd id="NBSdriver.minimize_window" class="function">minimize_window</dd>
                <dd id="NBSdriver.print_page" class="function">print_page</dd>
                <dd id="NBSdriver.switch_to" class="variable">switch_to</dd>
                <dd id="NBSdriver.back" class="function">back</dd>
                <dd id="NBSdriver.forward" class="function">forward</dd>
                <dd id="NBSdriver.refresh" class="function">refresh</dd>
                <dd id="NBSdriver.get_cookies" class="function">get_cookies</dd>
                <dd id="NBSdriver.get_cookie" class="function">get_cookie</dd>
                <dd id="NBSdriver.delete_cookie" class="function">delete_cookie</dd>
                <dd id="NBSdriver.delete_all_cookies" class="function">delete_all_cookies</dd>
                <dd id="NBSdriver.add_cookie" class="function">add_cookie</dd>
                <dd id="NBSdriver.implicitly_wait" class="function">implicitly_wait</dd>
                <dd id="NBSdriver.set_script_timeout" class="function">set_script_timeout</dd>
                <dd id="NBSdriver.set_page_load_timeout" class="function">set_page_load_timeout</dd>
                <dd id="NBSdriver.timeouts" class="variable">timeouts</dd>
                <dd id="NBSdriver.find_element" class="function">find_element</dd>
                <dd id="NBSdriver.find_elements" class="function">find_elements</dd>
                <dd id="NBSdriver.desired_capabilities" class="variable">desired_capabilities</dd>
                <dd id="NBSdriver.capabilities" class="variable">capabilities</dd>
                <dd id="NBSdriver.get_screenshot_as_file" class="function">get_screenshot_as_file</dd>
                <dd id="NBSdriver.save_screenshot" class="function">save_screenshot</dd>
                <dd id="NBSdriver.get_screenshot_as_png" class="function">get_screenshot_as_png</dd>
                <dd id="NBSdriver.get_screenshot_as_base64" class="function">get_screenshot_as_base64</dd>
                <dd id="NBSdriver.set_window_size" class="function">set_window_size</dd>
                <dd id="NBSdriver.get_window_size" class="function">get_window_size</dd>
                <dd id="NBSdriver.set_window_position" class="function">set_window_position</dd>
                <dd id="NBSdriver.get_window_position" class="function">get_window_position</dd>
                <dd id="NBSdriver.get_window_rect" class="function">get_window_rect</dd>
                <dd id="NBSdriver.set_window_rect" class="function">set_window_rect</dd>
                <dd id="NBSdriver.orientation" class="variable">orientation</dd>
                <dd id="NBSdriver.application_cache" class="variable">application_cache</dd>
                <dd id="NBSdriver.log_types" class="variable">log_types</dd>
                <dd id="NBSdriver.get_log" class="function">get_log</dd>
                <dd id="NBSdriver.bidi_connection" class="function">bidi_connection</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>